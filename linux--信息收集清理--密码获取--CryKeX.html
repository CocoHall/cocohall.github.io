<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>CryKeX</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>CryKeX</h1><br/>https://mp.weixin.qq.com/s/bSkc_zpKmOhuI9dEnXcuGA<br /><br />今天给大家介绍的是一款名叫CryKeX的工具，大家可以使用该工具从任何基于Unix操作系统的运行内存中提取出加密密钥。<br /><a href=""><img src="images\287-1.png" alt="images\287-1.png" /></a><br /><br />CryKeX特性<br />1.   跨平台<br />2.   简单实用<br />3.   交互性强<br />4.   兼容性/可移植性强<br />5.   应用程序独立<br />6.   进程封装/注入<br /><br />依赖条件<br />1.   Unix-理论上说，该工具可在任何基于Unix的操作系统平台上正常工作。<br />2.   BASH-支持所有脚本的运行。<br />3.   Root权限（可选项）<br /><br />限制条件<br />1.   仅支持AES和RSA密钥<br />2.   目前对Firefox浏览器的支持暂不完美<br />3.   不支持磁盘加密（LUKS）以及PGP/GPG<br />4.   需要适当的用户权限以及内存授权<br /><br />工作机制<br />基本上说，该工具会寻找某些类似密钥的数据，并通过分析其内存架构（C数据类型）来判断目标数据（密钥）的有效性。在此之前，我们也对DRAM的加密密钥安全问题进行了讨论，感兴趣的同学可以阅读下面给出的文章。<br />CryKeX可以导出目标进程的实时内存数据，然后从中寻找出可能存在的密钥信息，整个过程中内存映射并不会发生改变。工具脚本不仅能够向正在运行的进程中注入命令，而且还可以封装新的进程（通过单独启动进程后再进行注入来实现）。这样一来，该工具几乎就可以从目标系统中的任意进程/代码中提取密钥了。<br />当然了，系统内核会对内存访问等行为进行限制，这也就意味着你在进行操作的过程中需要一定的高级权限。<br />Linux磁盘加密（LUKS）使用了反取证技术来缓解这类安全问题，但是我们仍然有可能从一段完整的内存中提取出密钥。<br />Firefox浏览器使用了一些类似的内存管理机制，因此当前版本的CryKeX可能无法从Firefox浏览器中提取出密钥数据。除此之外，对于PGP/GPG也是一样的（不适用）。<br /><br />如何使用<br />安装依赖：<br /><br /><br />sudoapt install gdb aeskeyfind rsakeyfind || echo &#39;have you heard about sourcecompiling?&#39;针对openSSL AES密钥的交互示例：<br /><br /><br />opensslaes-128-ecb -nosalt -out testAES.enc输入一个密码两次，然后在命令终止运行之前输入一些文本：<br /><br /><br />CryKeX.shopenssl最后，按下组合键Ctrl+D三次来检查结果。<br />OpenSSLRSA密钥的交互示例：<br /><br /><br />opensslgenrsa -des3 -out testRSA.pem 2048提示输入密码：<br /><br /><br />CryKeX.shopenssl验证：<br /><br /><br />opensslrsa -noout -text -in testRSA.pem从SSH中提取密钥：<br /><br /><br />echo&#39;Ciphers aes256-gcm@openssh.com&#39; &gt;&gt; /etc/ssh/sshd_config<br /><br />ssh user@server<br /><br />CryKeX.shssh<br /><br />从OpenVPN中提取密钥：<br /><br /><br />echo&#39;cipher AES-256-CBC&#39; &gt;&gt; /etc/openvpn/server.conf<br /><br />openvpnyourConf.ovpn<br /><br />sudo CryKeX.sh openvpn<br /><br />TrueCrypt/VeraCrypt也同样会受到影响：选择VeraCrypt中的“veracrypt”文件，使用密码“pass”进行加载，然后运行下列命令：<br /><br /><br />sudo CryKeX.sh veracrypt基于Chromium的浏览器（多谢Google…）：<br /><br /><br />CryKeX.shchromiumCryKeX.shgoogle-chrome<br /><br />虽然我们的工具不适用于Firefox，但Tor浏览器Bundle可能会受到影响（由于其隧道机制）：<br /><br /><br />CryKeX.shtor除此之外，你还可以使用下列命令封装进程：<br /><br /><br />aptinstall libssl-devgcc-lcrypto cipher.c -o cipherCryKeX.shcipher       wrap       cipher<br /><br /><p align="center"><img src="images\home.svg" height="22" width="22">  <a href="index.html">索引</a></p></div></body></html>