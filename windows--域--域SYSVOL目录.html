<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>域SYSVOL目录</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>域SYSVOL目录</h1><br/>SYSVOL是AD（活动目录）里面一个存储域公共文件服务器副本的共享文件夹，所有的认证用户都可以读取。<br />SYSVOL包括登录脚本，组策略数据，以及其他域控所需要的域数据，会进行自动同步和共享。<br /><br />默认的共享路径：<br />\\&lt;DOMAIN&gt;\SYSVOL\&lt;DOMAIN&gt;\<br />例如：<br /><a href="file://\\rd.supcon.com\SYSVOL\rd.supcon.com">\\rd.supcon.com\SYSVOL\rd.supcon.com</a><br /><br />{31B2F340-016D-11D2-945F-00C04FB984F9} 默认的域策略<br />{6AC1786C-016F-11D2-945F-00C04fB984F9} 默认的域控策略<br /><br />组策略(GPP)，用于<br /><br />映射驱动（Drives.xml）<br />创建本地用户<br />数据源（DataSources.xml）<br />打印机配置（Printers.xml）<br />创建/更新服务（Services.xml）<br />计划任务（ScheduledTasks.xml）<br />更改本地Administrator密码<br /><br />查看自己的域ID<br /><br />在共享文件夹\SYSVOL中可看到组策略对应ID的文件夹<br /><br />例如：<br />\\test.local\SYSVOL\test.local\Policies\{E6424F10-C44B-4C45-8527-740189CBF60E}\User\Preferences\Groups<br /><br />Groups\Groups.xml<br />Services\Services.xml<br />ScheduledTasks\ScheduledTasks.xml<br />Printers\Printers.xml<br />Drives\Drives.xml<br />DataSources\DataSources.xml<br /><br /><a href=""><img src="images\268-1.png" alt="images\268-1.png" /></a><br /><br />值得注意的是其中的cpassword项，加密方式为AES 256，密钥如下<br /><br /><a href="https://msdn.microsoft.com/en-us/library/2c15cbf0-f086-4c74-8b70-1f2fa45dd4be.aspx?f=255&MSPPError=-2147217396">https://msdn.microsoft.com/en-us/library/2c15cbf0-f086-4c74-8b70-1f2fa45dd4be.aspx?f=255&amp;MSPPError=-2147217396</a><br /><br />4e 99 06 e8  fc b6 6c c9  fa f4 93 10  62 0f fe e8<br />f4 96 e8 06  cc 05 79 90  20 9b 09 a4  33 b6 6c 1b<br /><br />使用PowerShell脚本解密<br /><a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Get-GPPPassword.ps1">https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Get-GPPPassword.ps1</a><br /><br /><br />防：<br />• 在用于管理GPO的计算机上安装KB2962486,以防止将新凭据置于组策略首选项中。<br />• 设置Everyone访问权限<br />• 不在组策略中使用域控密码<br />• 设置共享文件夹SYSVOL的访问权限<br />• 删除现有的GPP里包含密码的xml文件<br /><br /><br />测试失败，没有上文的文件<br /><br /><br /><p align="center"><img src="images\home.svg" height="22" width="22">  <a href="index.html">索引</a></p></div></body></html>