<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>schtasks</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>schtasks</h1><br/>schtasks<br />(计划运行时会以 system 权限在远程系统上执行)<br /><br />常用命令 <br />在远程系统建立计划任务<br />schtasks /create /s 192.168.17.138 /u workgroup\administrator /p &quot;!@#123QWE&quot; /tn test /sc onstart /tr &quot;cmd.exe /c netstat -ano | findstr 3389 &gt;&gt; c:\programdata\error.log&quot; /ru system /f<br /><br /><br />在远程系统建立计划任务<br />schtasks /create /s 192.168.17.138 /u workgroup\administrator /p &quot;!@#123QWE&quot; /tn test /sc onstart /tr c:\programdata\test.bat /ru system /f<br /><br /><br />在远程系统建立计划任务,注：这条命令不支持 hash 注入后省去用户名密码执行<br />schtasks /create /s 192.168.17.138 /u workgroup\administrator /p &quot;!@#123QWE&quot; /tn test /sc onstart /tr &quot;cmd.exe /c whoami /all &gt;&gt; c:\programdata\error.log&quot; /ru &quot;workgroup\administrator&quot;<br /><br /><br />查看建立的计划任务是否正确<br />schtasks /query /s 192.168.17.138 /u workgroup\administrator /p &quot;!@#123QWE&quot; | findstr test<br /><br /><br />运行建立的计划任务<br />schtasks /run /s 192.168.17.138 /u workgroup\administrator /p &quot;!@#123QWE&quot;  /i /tn &quot;test&quot;<br /><br />删除建立的计划任务<br />schtasks /delete /s 192.168.17.138 /u workgroup\administrator /p &quot;!@#123QWE&quot; /tn &quot;test&quot; /f<br />工具说明<br />• 需要远程系统启动 Task Scheduler 服务<br /><br />• schtasks 不需要 RPC 服务的支持<br /><br />• 在条件允许的情况下，尽量使用 schtasks，因为在某些条件下，at 执行完任务后，任务信息没有删除（需要手动删除），用at命令查不到任务信息，但是用 schtasks 却能看到任务信息，任务名是At加一个数字(eg : At2)。 <p align="center"><img src="images\home.svg" height="22" width="22">  <a href="index.html">索引</a></p></div></body></html>